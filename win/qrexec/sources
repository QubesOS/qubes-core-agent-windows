TARGETNAME=qrexec_agent
TARGETTYPE=PROGRAM
TARGETPATH=bin


UMTYPE=console
USE_MSVCRT=1

UMENTRY = wmain
C_DEFINES = $(C_DEFINES)  /D_UNICODE /DUNICODE

INCLUDES=$(INCLUDES); \
                    $(SDK_INC_PATH)\..\ddk; \
                    ..\include; \
                    $(QUBES_INCLUDES);

SOURCES=qrexec_agent.c txrx-vchan.c service.c getopt.c log.c errors.mc errors.rc exec.c pipe_server.c

TARGETLIBS=\
        $(SDK_LIB_PATH)\kernel32.lib \
        $(SDK_LIB_PATH)\user32.lib \
        $(SDK_LIB_PATH)\setupapi.lib \
        $(SDK_LIB_PATH)\wtsapi32.lib \
        $(SDK_LIB_PATH)\userenv.lib \
        $(SDK_LIB_PATH)\advapi32.lib \
        $(SDK_LIB_PATH)\netapi32.lib \
        $(SDK_LIB_PATH)\Shlwapi.lib \
        $(QUBES_LIBS)\libvchan.lib \
        $(QUBES_LIBS)\libxenvchan.lib \
        ..\libs\*\qubes_utils.lib \

# TODO: Needs pkg-config equivalent for Windows to automatically fill above (at
#  least libxenvchan.lib)

